FROM --platform=$BUILDPLATFORM alpine
ARG LINK
ARG TARGETPLATFORM
COPY ./setup.sh /setup.sh
RUN /setup.sh

FROM node:lts-alpine
COPY --from=0 /boilerplate.zip /boilerplate.zip
COPY ./entrypoint.sh /
VOLUME ["/koishi"]
WORKDIR "/koishi"
RUN useradd -m koishi
USER koishi
ENTRYPOINT ["/entrypoint.sh"]
CMD ["yarn", "start"]
